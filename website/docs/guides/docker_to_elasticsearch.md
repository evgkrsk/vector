---
id: docker_to_elasticsearch
title: Writing Docker Events to Elasticsearch
description: Learn how to send Docker events to Elasticsearch with optional enrichments.
author_id: TODO
tags: ["type: guide"]
---

# Writing Docker Events to Elasticsearch

In this guide we'll be consuming `docker` logs and writing them to a `elasticsearch` sink.

<!--truncate-->

<!--
      THIS FILE IS AUTOGENERATED!

      To make changes please edit the template located at: scripts/generate/templates/guides/guide.md.erb
-->

## Setup

If you haven't already, install Vector. Here's a script for the lazy:

```bash
curl --proto '=https' --tlsv1.2 -sSf https://sh.vector.dev | sh
```

Or [choose your preferred installation method][docs.installation].

## Configure a Source

Next, create a config file and add a `docker` source:

```toml
[sources.my-source-id]
  # REQUIRED
  type = "docker" # must be: "docker"

  # OPTIONAL
  include_containers = ["my_container_name", "container_prefix", "9b6247364a03"] # example, no default
  include_labels = ["label_key1=label_value1", "label_key2=label_value2"] # example, no default
```

## (Optional) Parse Events

If our logs consumed from Docker are structured then we should
parse them. We can do that with a range of [transforms][docs.transforms], in
this example we will use the `json_parser` transform:

```toml
[transforms.parser]
  # REQUIRED
  type = "json_parser" # must be: "json_parser"
  inputs = ["my-source-id"] # example
  drop_invalid = true # example

  # OPTIONAL
  drop_field = true # default
  field = "message" # default
```

Note that for the `inputs` field we specify our `docker` source by
its name `my-source-id`.

This step is optional, if you choose to skip it then remember to set the
`inputs` of the next component to the previous component in the topology
(`my-source-id`).

## (Optional) Enrich Events

We can also choose to enrich our events with [transforms][docs.transforms]. In
this example we're going to add a `aws_ec2_metadata` transform:

```toml
[transforms.enricher]
  # REQUIRED
  type = "aws_ec2_metadata" # must be: "aws_ec2_metadata"
  inputs = ["parser"] # example

  # OPTIONAL
  fields = ["instance-id", "local-hostname", "local-ipv4", "public-hostname", "public-ipv4", "ami-id", "availability-zone", "vpc-id", "subnet-id", "region"] # default
  host = "http://169.254.169.254" # default
  namespace = "" # default
  refresh_interval_secs = 10 # default
```

Note that for the `inputs` field we specify `parser`.

This step is optional, if you choose to skip it then remember to set the
`inputs` of the next component to the previous component in the topology
(`parser`).

## Configure a Sink

Now we configure our sink, making sure to set the input to `enricher`:

```toml
[sinks.my-sink-id]
  # REQUIRED
  type = "elasticsearch" # must be: "elasticsearch"
  inputs = ["enricher"] # example

  # OPTIONAL
  host = "http://10.24.32.122:9000" # example, no default
  index = "vector-%F" # default
```

## Run It

That's it, we're ready to execute our pipeline. You can run it locally with:

```sh
vector -c ./config.toml
```

And choose from a range of strategies on [how to deploy it][docs.deployment].


[docs.deployment]: /docs/setup/deployment/
[docs.installation]: /docs/setup/installation/
[docs.transforms]: /docs/reference/transforms/
